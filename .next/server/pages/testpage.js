"use strict";(()=>{var e={};e.id=245,e.ids=[220,245],e.modules={671:(e,t)=>{Object.defineProperty(t,"M",{enumerable:!0,get:function(){return function e(t,s){return s in t?t[s]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,s)):"function"==typeof t&&"default"===s?t:void 0}}})},2752:(e,t,s)=>{s.r(t),s.d(t,{config:()=>P,default:()=>m,getServerSideProps:()=>b,getStaticPaths:()=>y,getStaticProps:()=>h,reportWebVitals:()=>x,routeModule:()=>E,unstable_getServerProps:()=>j,unstable_getServerSideProps:()=>w,unstable_getStaticParams:()=>_,unstable_getStaticPaths:()=>v,unstable_getStaticProps:()=>S});var r={};s.r(r),s.d(r,{default:()=>g});var a=s(3865),o=s(9455),n=s(671),i=s(781),l=s.n(i),u=s(3645),c=s.n(u),d=s(8732),p=s(2015),f=s(4822);let g=()=>{let[e,t]=(0,p.useState)(null),[s,r]=(0,p.useState)(!0),[a,o]=(0,p.useState)(""),[n,i]=(0,p.useState)(""),[l,u]=(0,p.useState)(!1),c=(0,f.useLocation)(),g=(0,f.useNavigate)(),{selectedExam:m}=c.state||{};(0,p.useEffect)(()=>{if(!m){g("/exam-selection");return}(async()=>{try{console.log(`Fetching question for exam: ${m}`),r(!0),i("");let e=await fetch(`http://localhost:5000/api/questions/random-question/${m}`);if(!e.ok)throw Error("Failed to fetch question from the server.");let s=await e.json();console.log("Question fetched successfully:",s),t(s.question)}catch(e){console.error("Error fetching question:",e),i("Failed to load question. Please try again later.")}finally{r(!1)}})()},[m,g]);let h=async()=>{if(l)return;if(!a.trim()){i("Essay cannot be empty.");return}let t=a.trim().split(/\s+/).length;if(t<20){i(`Essay must have at least 20 words. Current word count: ${t}.`);return}if(t>1e3){i(`Essay cannot exceed 1000 words. Current word count: ${t}.`);return}i(""),u(!0);try{let t={exam_id:m,essayText:a,userId:1};console.log("Submitting essay with payload:",t);let s=await fetch("http://localhost:5000/api/essays/submit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),r=await s.json();if(console.log("Server response:",r),!s.ok)throw Error(r.message||"Failed to submit essay");let o=r?.data?.essay?.evaluation?.essay_id;if(!o)throw console.error("Unexpected server response structure:",JSON.stringify(r,null,2)),Error("Could not find essay_id in server response");console.log("Essay submitted successfully with essay_id:",o),g("/resultpage",{state:{essay_id:o,question:e?.question_text,essay:a},replace:!0})}catch(e){console.error("Error submitting essay:",e),i(e.message||"Failed to submit essay. Please try again later.")}finally{u(!1)}};return s?(0,d.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:"Loading..."}):(0,d.jsx)("div",{className:"min-h-screen bg-gray-50 p-8",children:(0,d.jsx)("div",{className:"max-w-4xl mx-auto space-y-6",children:(0,d.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,d.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Question:"}),(0,d.jsx)("p",{className:"text-gray-700 mb-6",children:e?.question_text||"No question available"}),n&&(0,d.jsx)("p",{className:"text-red-500 mb-4",children:n}),(0,d.jsx)("textarea",{value:a,onChange:e=>o(e.target.value),placeholder:"Write your essay here...",className:"w-full h-64 p-4 border rounded-lg mb-4",disabled:l}),(0,d.jsx)("button",{onClick:h,className:`w-full px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 ${l?"opacity-50 cursor-not-allowed":""}`,disabled:l,children:l?"Submitting...":"Submit Essay"})]})})})},m=(0,n.M)(r,"default"),h=(0,n.M)(r,"getStaticProps"),y=(0,n.M)(r,"getStaticPaths"),b=(0,n.M)(r,"getServerSideProps"),P=(0,n.M)(r,"config"),x=(0,n.M)(r,"reportWebVitals"),S=(0,n.M)(r,"unstable_getStaticProps"),v=(0,n.M)(r,"unstable_getStaticPaths"),_=(0,n.M)(r,"unstable_getStaticParams"),j=(0,n.M)(r,"unstable_getServerProps"),w=(0,n.M)(r,"unstable_getServerSideProps"),E=new a.PagesRouteModule({definition:{kind:o.A.PAGES,page:"/testpage",pathname:"/testpage",bundlePath:"",filename:""},components:{App:c(),Document:l()},userland:r})},3645:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return l}});let r=s(9929),a=s(8732),o=r._(s(2015)),n=s(2811);async function i(e){let{Component:t,ctx:s}=e;return{pageProps:await (0,n.loadGetInitialProps)(t,s)}}class l extends o.default.Component{render(){let{Component:e,pageProps:t}=this.props;return(0,a.jsx)(e,{...t})}}l.origGetInitialProps=i,l.getInitialProps=i,("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},9455:(e,t)=>{Object.defineProperty(t,"A",{enumerable:!0,get:function(){return s}});var s=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})},361:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},2015:e=>{e.exports=require("react")},4822:e=>{e.exports=require("react-router-dom")},8732:e=>{e.exports=require("react/jsx-runtime")},3873:e=>{e.exports=require("path")}};var t=require("../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[781],()=>s(2752));module.exports=r})();