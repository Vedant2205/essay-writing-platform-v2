(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[245],{9084:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/testpage",function(){return s(1144)}])},1144:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var a=s(4848),o=s(6540),r=s(2815);let l=()=>{let[e,t]=(0,o.useState)(null),[s,l]=(0,o.useState)(!0),[n,i]=(0,o.useState)(""),[c,u]=(0,o.useState)(""),[d,h]=(0,o.useState)(!1),y=(0,r.zy)(),m=(0,r.Zp)(),{selectedExam:p}=y.state||{};(0,o.useEffect)(()=>{if(!p){m("/exam-selection");return}(async()=>{try{console.log("Fetching question for exam: ".concat(p)),l(!0),u("");let e=await fetch("http://localhost:5000/api/questions/random-question/".concat(p));if(!e.ok)throw Error("Failed to fetch question from the server.");let s=await e.json();console.log("Question fetched successfully:",s),t(s.question)}catch(e){console.error("Error fetching question:",e),u("Failed to load question. Please try again later.")}finally{l(!1)}})()},[p,m]);let f=async()=>{if(d)return;if(!n.trim()){u("Essay cannot be empty.");return}let t=n.trim().split(/\s+/).length;if(t<20){u("Essay must have at least 20 words. Current word count: ".concat(t,"."));return}if(t>1e3){u("Essay cannot exceed 1000 words. Current word count: ".concat(t,"."));return}u(""),h(!0);try{var s,a,o;let t={exam_id:p,essayText:n,userId:1};console.log("Submitting essay with payload:",t);let r=await fetch("http://localhost:5000/api/essays/submit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),l=await r.json();if(console.log("Server response:",l),!r.ok)throw Error(l.message||"Failed to submit essay");let i=null==l?void 0:null===(o=l.data)||void 0===o?void 0:null===(a=o.essay)||void 0===a?void 0:null===(s=a.evaluation)||void 0===s?void 0:s.essay_id;if(!i)throw console.error("Unexpected server response structure:",JSON.stringify(l,null,2)),Error("Could not find essay_id in server response");console.log("Essay submitted successfully with essay_id:",i),m("/resultpage",{state:{essay_id:i,question:null==e?void 0:e.question_text,essay:n},replace:!0})}catch(e){console.error("Error submitting essay:",e),u(e.message||"Failed to submit essay. Please try again later.")}finally{h(!1)}};return s?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:"Loading..."}):(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 p-8",children:(0,a.jsx)("div",{className:"max-w-4xl mx-auto space-y-6",children:(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Question:"}),(0,a.jsx)("p",{className:"text-gray-700 mb-6",children:(null==e?void 0:e.question_text)||"No question available"}),c&&(0,a.jsx)("p",{className:"text-red-500 mb-4",children:c}),(0,a.jsx)("textarea",{value:n,onChange:e=>i(e.target.value),placeholder:"Write your essay here...",className:"w-full h-64 p-4 border rounded-lg mb-4",disabled:d}),(0,a.jsx)("button",{onClick:f,className:"w-full px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 ".concat(d?"opacity-50 cursor-not-allowed":""),disabled:d,children:d?"Submitting...":"Submit Essay"})]})})})}},6069:(e,t)=>{"use strict";Object.prototype.toString}},e=>{var t=t=>e(e.s=t);e.O(0,[244,636,593,792],()=>t(9084)),_N_E=e.O()}]);